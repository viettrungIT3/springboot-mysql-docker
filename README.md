## Overview

**Enterprise-grade** Dockerized Spring Boot + MySQL application featuring modern architecture patterns with DTO-driven design, MapStruct mapping, comprehensive validation, and business logic integration. Built with Gradle using multi-stage Docker builds (no JDK required on host).

### üèóÔ∏è **Architecture Highlights:**
- ‚úÖ **DTO-First Design** - Complete separation between API contracts and domain entities
- ‚úÖ **MapStruct Integration** - High-performance compile-time mapping 
- ‚úÖ **Business Logic** - Automatic inventory management, order processing
- ‚úÖ **Security** - BCrypt password encryption, input validation
- ‚úÖ **RESTful APIs** - CRUD + pagination + advanced operations

## Prerequisites
- Docker Desktop (or Docker Engine + Compose plugin)

## Quick Start
```bash
# 1) Configure environment
cp .env.example .env    # edit values if needed

# 2) Build and start
docker compose up -d --build

# 3) Open the app
# Backend: http://localhost:${BACKEND_PORT:-8080}
# Swagger UI: http://localhost:${BACKEND_PORT:-8080}/swagger-ui.html
```

To stop:
```bash
docker compose down
```

Reset all data (recreate DB volume) and rebuild:
```bash
docker compose down -v
docker compose up -d --build
```

## Environment (.env)
Edit `.env` to manage all configs (no code changes required):
```env
# Database configuration
MYSQL_ROOT_PASSWORD=root
MYSQL_DATABASE=appdb
MYSQL_USER=appuser
MYSQL_PASSWORD=apppass
MYSQL_PORT=3306        # exposed port on host

# Backend configuration
BACKEND_PORT=8080      # exposed port on host

# DB connection seen by backend inside Docker network
DB_HOST=mysql
DB_PORT=3306

# JPA/Hibernate (Flyway manages schema)
JPA_DDL_AUTO=none
JPA_SHOW_SQL=true

# Optional: basic user for Spring Security (dev only)
# SPRING_SECURITY_USER_NAME=admin
# SPRING_SECURITY_USER_PASSWORD=admin

# Data Seeding (dev/test profiles only)
# Choose one profile:
SPRING_PROFILES_ACTIVE=dev    # For development with seeding
# SPRING_PROFILES_ACTIVE=test  # For testing with seeding  
# SPRING_PROFILES_ACTIVE=prod  # For production without seeding

APP_SEED_ENABLED=true
APP_SEED_PRODUCTS=15
APP_SEED_CUSTOMERS=10
```

## Project Structure
```
springboot-mysql-docker/
‚îú‚îÄ backend/
‚îÇ  ‚îú‚îÄ Dockerfile                     # multi-stage: builds JAR inside Docker
‚îÇ  ‚îú‚îÄ build.gradle                   # MapStruct + Lombok + Spring Boot
‚îÇ  ‚îú‚îÄ gradle/, gradlew, settings.gradle
‚îÇ  ‚îî‚îÄ src/main/java/com/backend/backend/
‚îÇ     ‚îú‚îÄ BackendApplication.java
‚îÇ     ‚îú‚îÄ config/
‚îÇ     ‚îÇ  ‚îú‚îÄ OpenApiConfig.java
‚îÇ     ‚îÇ  ‚îú‚îÄ SecurityConfig.java      # BCrypt password encoder
‚îÇ     ‚îÇ  ‚îú‚îÄ SeedProperties.java      # Data seeding configuration
‚îÇ     ‚îÇ  ‚îî‚îÄ AppConfig.java           # Configuration properties binding
‚îÇ     ‚îú‚îÄ dto/                        # DTO-first design
‚îÇ     ‚îÇ  ‚îú‚îÄ common/PageResponse.java
‚îÇ     ‚îÇ  ‚îú‚îÄ product/                 # Use-case driven DTOs
‚îÇ     ‚îÇ  ‚îú‚îÄ customer/, supplier/, administrator/
‚îÇ     ‚îÇ  ‚îú‚îÄ order/, orderitem/, stockentry/
‚îÇ     ‚îÇ  ‚îî‚îÄ ...CreateRequest, ...UpdateRequest, ...Response
‚îÇ     ‚îú‚îÄ entity/                     # JPA entities with Lombok
‚îÇ     ‚îÇ  ‚îú‚îÄ base/AuditableEntity.java # Base class with audit fields
‚îÇ     ‚îÇ  ‚îú‚îÄ Product.java, Supplier.java, Customer.java
‚îÇ     ‚îÇ  ‚îú‚îÄ Order.java, OrderItem.java, StockEntry.java
‚îÇ     ‚îÇ  ‚îî‚îÄ Administrator.java
‚îÇ     ‚îú‚îÄ mapper/                     # MapStruct mappers
‚îÇ     ‚îÇ  ‚îú‚îÄ ProductMapper.java, CustomerMapper.java
‚îÇ     ‚îÇ  ‚îú‚îÄ OrderMapper.java, StockEntryMapper.java
‚îÇ     ‚îÇ  ‚îî‚îÄ ...Mapper.java (auto-generated implementations)
‚îÇ     ‚îú‚îÄ repository/                 # Spring Data JPA
‚îÇ     ‚îÇ  ‚îú‚îÄ ProductRepository.java, CustomerRepository.java
‚îÇ     ‚îÇ  ‚îî‚îÄ ...Repository.java
‚îÇ     ‚îú‚îÄ bootstrap/                  # Application startup components
‚îÇ     ‚îÇ  ‚îî‚îÄ DevTestDataSeeder.java   # Profile-based data seeding
‚îÇ     ‚îú‚îÄ service/                    # Business logic layer
‚îÇ     ‚îÇ  ‚îú‚îÄ ProductService.java      # Inventory management
‚îÇ     ‚îÇ  ‚îú‚îÄ OrderService.java        # Complex order processing
‚îÇ     ‚îÇ  ‚îî‚îÄ ...Service.java          # Stock updates, totals calculation
‚îÇ     ‚îú‚îÄ util/                       # Utility classes
‚îÇ     ‚îÇ  ‚îú‚îÄ SlugUtil.java            # Slug generation and validation
‚îÇ     ‚îÇ  ‚îî‚îÄ PageMapper.java          # Pagination utility
‚îÇ     ‚îú‚îÄ controller/                 # RESTful API layer
‚îÇ     ‚îÇ  ‚îú‚îÄ ProductController.java   # /api/v1/products
‚îÇ     ‚îÇ  ‚îú‚îÄ OrderController.java     # /api/v1/orders
‚îÇ     ‚îÇ  ‚îî‚îÄ ...Controller.java       # CRUD + pagination + custom endpoints
‚îÇ     ‚îî‚îÄ exception/                  # Global error handling
‚îÇ        ‚îú‚îÄ GlobalExceptionHandler.java
‚îÇ        ‚îî‚îÄ ResourceNotFoundException.java
‚îú‚îÄ backend/src/main/resources/db/migration/
‚îÇ  ‚îú‚îÄ V1__init.sql                   # Flyway schema migration
‚îÇ  ‚îú‚îÄ V2__seed_base.sql              # Flyway seed data migration
‚îÇ  ‚îú‚îÄ V3__add_slug_products_customers.sql # Slug support migration
‚îÇ  ‚îî‚îÄ V4__add_audit_and_soft_delete.sql   # Audit fields and soft delete migration
‚îú‚îÄ docs/                             # Documentation
‚îÇ  ‚îú‚îÄ README_day1.md, README_day2.md
‚îÇ  ‚îú‚îÄ README_day3.md, README_day4.md
‚îÇ  ‚îî‚îÄ ...
‚îú‚îÄ docker-compose.yml
‚îú‚îÄ .env (copy from .env.example)
‚îú‚îÄ makefile                          # Development utilities
‚îî‚îÄ README.md
```

## Services (Docker Compose)
- mysql
  - Image: `mysql:8.4`
  - Ports: `${MYSQL_PORT:-3306}:3306`
  - Env: `MYSQL_ROOT_PASSWORD`, `MYSQL_DATABASE`, `MYSQL_USER`, `MYSQL_PASSWORD`
  - Volumes:
    - Named volume for data (`db_data`)
    - ‚úÖ **Flyway migrations** handle schema initialization automatically

- backend
  - Build: `backend/Dockerfile` (multi-stage: JDK build -> JRE runtime)
  - Ports: `${BACKEND_PORT:-8080}:8080`
  - Env: `SPRING_DATASOURCE_*`, `JPA_*`, `APP_SEED_*` (derived from `.env`)
  - ‚úÖ **Data Seeding** automatically runs for dev/test profiles with configurable quantities

## Swagger
- Swagger UI: `http://localhost:${BACKEND_PORT:-8080}/swagger-ui.html`
- OpenAPI JSON: `http://localhost:${BACKEND_PORT:-8080}/v3/api-docs`

## üöÄ API Overview

### **Modern RESTful Endpoints** with DTO-driven design:

#### **Core Resources** (Full CRUD + Pagination):
- üõçÔ∏è **Products**: `/api/v1/products` - Inventory management with stock tracking
- üë• **Customers**: `/api/v1/customers` - Customer management
- üè™ **Suppliers**: `/api/v1/suppliers` - Supplier relationships  
- üë®‚Äçüíº **Administrators**: `/api/v1/administrators` - User management with secure passwords
- üì¶ **Stock Entries**: `/api/v1/stock-entries` - Inventory transactions
- üìã **Orders**: `/api/v1/orders` - Complex order processing
- üì¶ **Order Items**: `/api/v1/order-items` - Individual order line items

#### **Advanced Features**:
- ‚úÖ **Pagination**: `/page` endpoints with sorting
- ‚úÖ **Partial Updates**: PATCH operations with selective field updates  
- ‚úÖ **Business Logic**: Automatic stock management and calculations
- ‚úÖ **Validation**: Comprehensive input validation with meaningful errors
- ‚úÖ **Security**: Password encryption and sensitive data protection
- ‚úÖ **Slug Access**: Dual access patterns with both ID and slug-based endpoints
- ‚úÖ **Soft Delete**: Records are marked as deleted but remain in database
- ‚úÖ **Audit Trail**: Automatic timestamp management for all entities

### **Example API Usage**:

#### **Product Management**:
```bash
# Create product with validation
curl -X POST http://localhost:8080/api/v1/products \
  -H 'Content-Type: application/json' \
  -d '{"name":"Laptop","description":"Gaming laptop","price":1299.99,"quantityInStock":10}'

# Get paginated products
curl "http://localhost:8080/api/v1/products/page?page=0&size=5&sort=name"

# Partial update (only price)
curl -X PATCH http://localhost:8080/api/v1/products/1 \
  -H 'Content-Type: application/json' \
  -d '{"price":1199.99}'

# Access by slug (alternative to ID)
curl "http://localhost:8080/api/v1/products/slug/gaming-laptop"

# Soft delete (record remains in database with deleted_at timestamp)
curl -X DELETE http://localhost:8080/api/v1/products/1
# Response: 204 No Content (record still exists in DB but filtered from queries)
```

#### **Order Processing** (with automatic stock updates):
```bash
# Create complex order with multiple items
curl -X POST http://localhost:8080/api/v1/orders \
  -H 'Content-Type: application/json' \
  -d '{
    "customerId": 1,
    "items": [
      {"productId": 1, "quantity": 2},
      {"productId": 2, "quantity": 1}
    ]
  }'

# Response includes automatic calculations:
{
  "id": 1,
  "totalAmount": 156.18,           # Auto-calculated
  "orderDate": "2025-09-04T15:24:11Z",
  "items": [
    {
      "totalPrice": 2599.98,       # Auto-calculated  
      "quantity": 2,
      "price": 1299.99
    }
  ]
}

# Add item to existing order
curl -X POST "http://localhost:8080/api/v1/orders/1/items?productId=3&quantity=1"
```

#### **Inventory Management**:
```bash
# Add stock (automatically updates product inventory)
curl -X POST http://localhost:8080/api/v1/stock-entries \
  -H 'Content-Type: application/json' \
  -d '{"productId": 1, "supplierId": 1, "quantity": 50}'
```

#### **Secure Administration**:
```bash
# Create admin with encrypted password
curl -X POST http://localhost:8080/api/v1/administrators \
  -H 'Content-Type: application/json' \
  -d '{
    "username": "admin1", 
    "password": "securepass123", 
    "email": "admin@company.com",
    "fullName": "System Administrator"
  }'

# Response excludes password for security
{
  "id": 1,
  "username": "admin1",
  "email": "admin@company.com", 
  "fullName": "System Administrator"
}
```

## Default Credentials
- MySQL root: `root` / `root`
- MySQL app user: `appuser` / `apppass` (DB: `appdb`)

## Useful Commands
```bash
# Start in background
docker compose up -d --build

# Tail logs
docker compose logs -f backend
docker compose logs -f mysql

# Stop containers
docker compose down

# Reset volumes (wipe DB)
docker compose down -v && docker compose up -d --build
```

## Troubleshooting
- Port already in use
  - Change `BACKEND_PORT` or `MYSQL_PORT` in `.env` and `docker compose up -d --build`.
- MySQL password or db name not applied
  - MySQL uses a persisted volume. Run `docker compose down -v` to remove volume and re-initialize.
- Slow or failing dependency downloads during Docker build
  - The Dockerfile retries Gradle steps and caches Gradle; re-run `docker compose up -d --build`.
- Swagger not accessible
  - Ensure backend is healthy: `docker compose logs backend`. Open `http://localhost:${BACKEND_PORT}/swagger-ui.html`.




-----

## üóìÔ∏è Development Journey

### ‚úÖ Day 1 ‚Äî Makefile & Dev UX
* **Goal:** `make up`, `make down`, `make logs`, `make rebuild`.  
* **Criteria:** Makefile works on macOS/Linux; README is updated.  
* **üìñ [README Day 1](docs/README_day1.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/1/files)**

### ‚úÖ Day 2 ‚Äî Profiles & Isolated Configuration  
* **Goal:** `application.yml` with `dev`, `test`, `prod` profiles; use environment overrides.  
* **Criteria:** Run dev via Docker Compose; DB configuration comes from .env.  
* **üìñ [README Day 2](docs/README_day2.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/2/files)**

### ‚úÖ Day 3 ‚Äî Validation & Global Error Handling
* **Goal:** Bean Validation (JSR-380) for incoming DTOs; @ControllerAdvice + standardized JSON errors.  
* **Criteria:** 400 response with clear field errors.  
* **üìñ [README Day 3](docs/README_day3.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/3/files)**

### ‚úÖ Day 4 ‚Äî DTO + MapStruct
* **Goal:** Separate DTOs from entities, use MapStruct mappers.
* **Criteria:**  Controller only receives/returns DTOs; mappers have simple tests.
* **üéØ COMPLETED:** Enterprise-grade architecture with 21 DTOs, 7 MapStruct mappers, business logic integration  
* **üìñ [README Day 4](docs/README_day4.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/4/files)**

### ‚úÖ Day 5 ‚Äî Pagination, Sort, Filter
* **Goal:** Standardize list endpoints: `?page=‚Ä¶&size=‚Ä¶&sort=‚Ä¶&search=‚Ä¶`
* **Criteria:** Swagger displays correct parameters; returns `Page` metadata.
* **üéØ COMPLETED:** Standardized pagination with PageResponse<T>, PageMapper utility, search functionality and comprehensive Swagger documentation
* **üìñ [README Day 5](docs/README_day5.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/5/files)**

### ‚úÖ Day 6 ‚Äî Swagger Polish + OpenAPI
* **Goal:** Title, description, contact, server URLs; tag endpoints.
* **Criteria:** `/v3/api-docs` is valid; `swagger-ui.html` looks good, has examples.
* **üéØ COMPLETED:** 
* **üìñ [README Day 6](docs/README_day6.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/6/files)**

### ‚úÖ Day 7 ‚Äî Basic Unit Testing
* **Goal:** JUnit 5 + Mockito for the core service layer.
* **Criteria:** Coverage > 50% for core services.
* **üéØ COMPLETED:** 
* **üìñ [README Day 7](docs/README_day7.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/7/files)**

### ‚úÖ Day 8 ‚Äî Testcontainers for Integration Tests
* **Goal:** Spin up MySQL with Testcontainers, test repositories.
* **Criteria:** Tests run with ./gradlew test without needing a local MySQL installation.
* **üéØ COMPLETED:** 
* **üìñ [README Day 8](docs/README_day8.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/8/files)**

### ‚úÖ Day 9 ‚Äî Flyway Migrations üõ´
* **Goal:** Move schema and seed from init_database.sql to Flyway V1__init.sql. App auto-migrate on start; remove mount init SQL in Compose.
* **Criteria:** Flyway is the single source of truth; Testcontainers work with migrations.
* **üéØ COMPLETED:** Enterprise-grade database migration strategy with Flyway, single source of truth cho schema, automated migrations
* **üìñ [README Day 9](docs/README_day9.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/9/files)**

### ‚úÖ Day 10 ‚Äî Data Seeding with Docker & Makefile üå±
* **Goal:** Lightweight data seeding for dev/test (CommandLineRunner) with configurable and idempotent capabilities.
* **Criteria:** Dev startup has sample products, customers,... Disabled in prod. Idempotent (no duplicates on restart), configurable quantities via environment variables.
* **üéØ COMPLETED:** Profile-based data seeding with DataFaker, idempotent seeding, configurable quantities, Docker & Makefile integration
* **üìñ [README Day 10](docs/README_day10.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/10/files)**

### ‚úÖ Day 11 - ‚Äî Standardized Logging
* **Goal:** Logback JSON (profile-dependent), correlation ID filter.
* **Criteria:** Logs have a traceId; log level can be configured via environment variable: LOG_LEVEL=INFO.
* **üéØ COMPLETED:** 
* **üìñ [README Day 11](docs/README_day11.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/11/files)**

### ‚úÖ Day 12 ‚Äî Global ID/Slug Feature üîó
* **Goal:** Add slug support for Products and Customers with automatic generation and uniqueness validation.
* **Criteria:** Slug auto-generated from name, unique constraint, API endpoints support both ID and slug access.
* **üéØ COMPLETED:** Global slug system with SlugUtil, unique constraints, dual access patterns (ID/slug), comprehensive API coverage
* **üìñ [README Day 12](docs/README_day12.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/12/files)**

### ‚úÖ Day 13 ‚Äî Soft Delete & Auditing üóëÔ∏è‚è±Ô∏è
* **Goal:** Add audit fields (created_at, updated_at, deleted_at) and implement soft delete for all entities.
* **Criteria:** Soft delete is the default; deleted records are filtered out; audit timestamps are automatically managed.
* **üéØ COMPLETED:** Complete audit system with AuditableEntity base class, soft delete implementation, automatic timestamp management, SQL restriction filtering
* **üìñ [README Day 13](docs/README_day13.md)**
* **[Git changelog](https://github.com/viettrungIT3/springboot-mysql-docker/pull/13/files)**

---

## üèÜ **Current Architecture Status**

### **‚úÖ Completed Features:**
- üîß **Development UX**: Comprehensive Makefile with 20+ commands
- ‚öôÔ∏è **Configuration Management**: Multi-profile application.yml with environment isolation  
- üõ°Ô∏è **Input Validation**: Bean Validation with global error handling
- üèóÔ∏è **DTO Architecture**: Complete separation of API contracts from domain entities
- üöÄ **MapStruct Integration**: High-performance compile-time mapping
- üíº **Business Logic**: Inventory management, order processing, automatic calculations
- üîê **Security**: BCrypt password encryption, sensitive data protection
- üìä **APIs**: 50+ RESTful endpoints with pagination, sorting, filtering and search
- üìÑ **Pagination**: PageResponse<T> standard with metadata, PageMapper utility
- üìñ **Documentation**: Swagger/OpenAPI with detailed parameter descriptions
- üõ´ **Database Migrations**: Flyway-based schema management with automated migrations
- üå± **Data Seeding**: Profile-based seeding with DataFaker, idempotent seeding, configurable quantities
- üîó **Slug System**: Global slug support for Products and Customers with dual access patterns
- üóëÔ∏è **Soft Delete & Auditing**: Complete audit trail with automatic timestamp management and soft delete functionality

### **üìà Technical Metrics:**
- **7 Domain Entities** with Lombok integration and AuditableEntity base class
- **21 DTOs** designed with use-case patterns
- **7 MapStruct Mappers** with relationship handling
- **1 PageMapper Utility** for pagination standardization
- **1 SlugUtil Utility** for slug generation and validation
- **1 AuditableEntity Base Class** with automatic timestamp management
- **14 Controllers** with consistent RESTful design and Swagger docs
- **4 Flyway Migrations** with automated schema management and audit fields
- **1 Data Seeder** with profile-based configuration and idempotent seeding
- **Zero Manual Mapping** - All automated with type safety
- **Unified Pagination** - All list endpoints use PageResponse<T>
- **Dual Access Patterns** - ID and slug-based API endpoints
- **Soft Delete System** - All entities support soft delete with SQL restriction filtering
- **Complete Audit Trail** - Automatic created_at, updated_at, deleted_at management
- **Single Source of Truth** - Schema managed in Flyway migrations
- **Automated Data Seeding** - Development/test environments ready with sample data

**üåü Ready for production deployment with enterprise-grade patterns!**

